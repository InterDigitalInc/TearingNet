# Train the TearingNet

EXP="train_tearing_cad"
PY_NAME="${HOME_DIR}/experiments/train_tearing.py"
EXP_NAME="results/${EXP}"
CHECKPOINT="${HOME_DIR}/results/train_folding_cad/epoch_639.pth"
LOAD_WEIGHT_ONLY="True"
PHASE="train"
N_EPOCH="480"
SAVE_EPOCH_FREQ="10"
PRINT_FREQ="50"
PC_WRITE_FREQ="1000"
BATCH_SIZE="32"
XYZ_LOSS_TYPE="0"
LR_POLICY="step"
LR="0.000001 80 0.5"
DATASET_NAME="cad_mulobj"
TRAIN_SPLIT="train_5x5"
AUGMENTATION="True"
AUGMENTATION_ROTATION_AXIS="1"
GRID_DIMS="45 45"
ENCODER="pointnetvanilla"
DECODER="tearingnetgraph"
POINTNET_MLP_DIMS="3 64 64 64 128 1024"
POINTNET_FC_DIMS="1024 512 512"
POINTNET_MLP_DOLASTRELU="False"
FOLDING1_DIMS="514 512 512 3"
FOLDING2_DIMS="515 512 512 3"
TEARING1_DIMS="517 512 512 64"
TEARING2_DIMS="581 512 512 2"
GRAPH_R="1e-12"
GRAPH_EPS="0.02"
GRAPH_LAM="0.5"

RUN_ARGUMENTS="${PY_NAME} --exp_name ${EXP_NAME} --checkpoint ${CHECKPOINT} --load_weight_only ${LOAD_WEIGHT_ONLY} --phase ${PHASE} --n_epoch ${N_EPOCH} --save_epoch_freq ${SAVE_EPOCH_FREQ} --print_freq ${PRINT_FREQ} --pc_write_freq ${PC_WRITE_FREQ} --batch_size ${BATCH_SIZE} --xyz_loss_type ${XYZ_LOSS_TYPE} --lr_policy ${LR_POLICY} --lr ${LR} --dataset_name ${DATASET_NAME} --train_split ${TRAIN_SPLIT} --augmentation ${AUGMENTATION} --augmentation_rotation_axis ${AUGMENTATION_ROTATION_AXIS} --grid_dims ${GRID_DIMS} --encoder ${ENCODER} --decoder ${DECODER} --pointnet_mlp_dims ${POINTNET_MLP_DIMS} --pointnet_fc_dims ${POINTNET_FC_DIMS} --pointnet_mlp_dolastrelu ${POINTNET_MLP_DOLASTRELU} --folding1_dims ${FOLDING1_DIMS} --folding2_dims ${FOLDING2_DIMS} --tearing1_dims ${TEARING1_DIMS} --tearing2_dims ${TEARING2_DIMS} --graph_r ${GRAPH_R} --graph_eps ${GRAPH_EPS} --graph_lam ${GRAPH_LAM}"